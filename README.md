# paxlovid_drug_interaction
Paxlovid 藥物交互作用檢核程式
---
雖然現在上傳這隻程式已經有點晚了，畢竟國內的疫情已經趨緩到一個程度 (2022/12/05)，使用Paxlovid的時機會在更少。
但是套一句今年 (2022)在聯合藥學研討會聽到的一句話，從以前到現在我們沒有這麼在意過某個特定藥物的交互作用。Paxlovid在交互作用的歷史上一定有所定位，這隻程式希望未來不要再有因為這種鳥疫情用到的一天，但是還是紀錄一下。

這隻程式一開始只有抓本院HIS的資料，這部分的語法再公開版都刪除了，所以應該還是會有機會看到一些殘餘的語法。

## 關於使用部分
1. 環境變數，requirements.txt和requirements.yml挑一個就好。部分程式碼裡面也會寫到需要那些套件
2. 可以自行輸入健保藥品查詢交互作用
3. 可以複製健保雲端藥歷內容再作交互作用檢核
4. 爬蟲的部分僅支援IE，對Win 10的用戶就沒辦法
5. files裡面有record.pkl這個是用於紀錄查詢結果，裡面會有病人個資，傳送資料時請注意
6. record.xlsx是每次紀錄時會同時用record.pkl創一個新的，目的只是讓不會用python的同事可以看之前的紀錄，他們可能會有別的想法

---

## 開發小記錄
### 先講一下交互作用database的部分
1. 主要由衛服部提供的Paxlovid交互作用為基礎
2. 因為有發現衛服部的資料未涵蓋一些常用藥物，因此用一位高醫學姊的整理資料再作了延伸
3. 最後覺得還是用uptodate再check一次，所以會有較多的資料
4. 目標是希望藥師能看到結果就能快速給予病人指引

### 關於健保藥品檔
1. 後來新增讓藥師能自行輸入商品名或學名等資料查詢藥品功能
2. 這邊只有健保藥品，不過要改成全國藥品並不是難事，修改nhi_med.pkl就可以了
3. 更新的部分也做在裡面

### 關於複製健保雲端藥歷
1. 主要是參考這個： https://depart.femh.org.tw/meta/femhpaxlovid.htm?0.48584163252279633
2. 沒辦法完全復刻他的做法，程度還不夠，在自己的電腦嘗試是沒問題的
3. 複製健保雲端藥歷不支援IE，這主要是因為IE複製下來表格之間是用空白區分，而不是用tab，沒辦法抓到那個切割點

### 關於雲端藥歷爬蟲
1. 我知道有些醫院可以接API去抓健保局的資料，但是我們不行，事前簽屬下載雲端這件事情，對paxlovid臨床情境也不適用。我也知道爬蟲這件事其實有點法律爭議，但是這樣能快速取得病人用藥清單，所以只能這樣
2. 為什麼不用chrome或其他比較新的，這部分是因為跑起來都會跳錯誤，不清楚是不是有防爬設計
3. 用IE的好處是他沒有版本問題，所以不用在意版本更新。缺點就是慢還有，win10以上IE被強制停用了
4. 速度會有點慢主要也是因為IE慢，所以每個步驟都要多sleep一點來等IE真的跑完

### 開發的一些筆記
1. 一開始只是想說快速應變一下paxlovid的交互作用問題，主程式開發大概只用了2天，因為大部分的程式都是參考以前的
2. 後來疫情開始大爆炸，過來問的病人親友變多之後，就會發現這個程式的不足，沒有院外藥物
3. 後來才加上可以塞入健保藥物，當時有考慮用爬蟲，但是爬蟲的語法寫起來比較麻煩，就先放著
4. 之後查資料的時候看到有其他人做可以用複製的方式做，覺得自己應該也可以刻一個一樣的，但是沒那麼簡單，這邊大概卡關卡了1周
5. 後續作出複製功能後，因為同事習慣用IE開雲端藥歷，才發現用IE複製的格式會以空白當作分隔，和chrome與firefox不同
6. 終於狠下心去寫爬蟲了，Chrome、Firefox都會跳出錯誤訊息無法運作，只能乖乖回去用IE
7. 最後才想到應該記錄一下，其實這個應該在最前面就要做了，因為這樣之前查詢的紀錄都沒紀錄
